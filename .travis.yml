language: objective-c
cache: bundler
before_script:
  - openssl aes-256-cbc -k "$ENCRYPTION_SECRET" -in scripts/profile/TravisExample_Ad_Hoc.mobileprovision.enc -d -a -out scripts/profile/TravisExample_Ad_Hoc.mobileprovision
  - openssl aes-256-cbc -k "$ENCRYPTION_SECRET" -in scripts/certs/dist.cer.enc -d -a -out scripts/certs/dist.cer
  - openssl aes-256-cbc -k "$ENCRYPTION_SECRET" -in scripts/certs/dist.p12.enc -d -a -out scripts/certs/dist.p12
  - ./scripts/add-key.sh
  - ./scripts/update-bundle.sh
script:
  - xctool -workspace TravisExample.xcworkspace -scheme TravisExample -sdk iphoneos -configuration Release OBJROOT=$PWD/build SYMROOT=$PWD/build ONLY_ACTIVE_ARCH=NO TESTFLIGHT_APP_TOKEN=$TESTFLIGHT_APP_TOKEN HOCKEY_APP_ID=$HOCKEY_APP_ID
  - xctool test -workspace TravisExample.xcworkspace -scheme TravisExampleTests -sdk iphonesimulator ONLY_ACTIVE_ARCH=NO
after_script:
  - ./scripts/remove-key.sh
after_success:
  - ./scripts/sign-and-upload.sh
env:
  global:
  - APP_NAME="TravisExample"
  - 'DEVELOPER_NAME="iPhone Distribution: Mattes Groeger"'
  - PROFILE_NAME="TravisExample_Ad_Hoc"
  - INFO_PLIST="TravisExample/TravisExample-Info.plist"
  - BUNDLE_DISPLAY_NAME="Travis Example CI"
  - secure: DIchIuFEgci+P22qn22RiWmgPbgvKq37KE0ZmBj7rxAgx8nVwKpl7NefGJFcyTgYO0/utXxLzFAytl+6yER0nO5ANj8xXl5+mpG25+fA9HWZ2gscYTwG+tCbKF0AVb31KoC01AKJoVVbKbFKhtRGLXn9JVYqt9CDKH3LAeTGy+Y=
  - secure: FCHVWUdBEnUvf3tP5uSq6ls+jMOm9xhf6kGKqmNDHZPEYt3wz9Al3pPKO8eqPkVc61uRbtcUkjMS2q9afG70n/K+GUfaLyzWOEUh+yt9dKOz1t8yJzkX5OE2yaD7ieFNZy+TZQmrJ3PH7hGQku3rXJDmW5lD1OWHGLhoIK9UU4k=
  - secure: DhykeSchRHwyac4gFG9fyKQm/BPQcH/+bTpntEQ/Ta3bPk+IMDS9yNBVUxgDwP2Rg1XvNGvMVlSId8Fh2j0Vo08mMbyFSjPluOcJdDxOppNU3kNnL/MdkFyofHaMZTo30Yd6FM6wMTRnOwoqlTXqiRpyDceDJNj0ymO8OznRxlE=
  - secure: jjQ/mtPZzxTDvosoG61Eg01maCENg6Vr+vuR98ZQ3XsWgScBKB5P30plkA4/gOluwkZKnfgrpGnDtJiyZl8A3myeKOFQQ1NmHa6wjonrbjK8k0ZNsMpAxgmzr9wCduVhSq2FwHfxpBlffJLpXc5lin3UbGM7gOszS4xaDHNoLW8=
  - secure: bhIDWenxqt9MVf5vo8t3b0q6N9dO/fGdf1A5Y+Bdzto6/i8rllnlQJH27YW3KGFvVsNtgj46h9BzbaAUqpy09K0km/j6AeJWK/IjiDONEhgZV2iTPtZjOvNFk91Xo4lweFtW2jYW/PFlctnpHukApyefs/h8Xc7R6Zqc4v8kEWM=
  - secure: fRDTAC74m0lUPT0/MSjmzRoC6JsVPtJYRSzAaiwsJdrQkgGCync5BX6UIYE1/mGtRAQelURGDVTWaOTyHdQVlf8VL2aMA12ZGdQ3qjNTWSz69T7W7tLPg0mIpRGyJ+vBTILP8UvuGBZfuO6aKPLVOCsIZfjIfzhlwcbg4P29wIM=
  - secure: eegMwZGMDYur9C3XT67AVeCu6kOf2X4ZeAXsRPTMtBkrydOqu6HOdfsBW1WMOxXAJjkYvblPQC7BcwLxhFh6ZPbJKm5JlWBiC5PHKtLCZ6wqk8LTnebcyQ5OeRJwxMyZQoZSTuuwH9bVTDlEqs4S+7e2BBXwdZ2xW1H4+/HjJHY=
